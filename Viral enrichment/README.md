A viral enrichment score per cluster was calculated as previously[7,120]. The enrichment score for a given cluster C is defined as: EnrichmentI = log( ( Observed( Vcells in C ) + ε ) / ( Expected( Vcells in C ) + ε )) = log( ( Vcells in C ) + ε ) / ( ( Vcells in total * X_c ) + ε ) where Vcells are the SARS-Cov-2 RNA+ nuclei, X_c is the proportion of the total number of nuclei in cluster C out of the total number of nuclei in its corresponding compartment, and ε = 0.0001. We only considered samples with at least 5 SARS-Cov-2 RNA+ nuclei. We derived the null distribution of each enrichment score by permuting the data and assigning the same number of SARS-Cov-2 RNA+ labels to nuclei, such that the overall proportion of SARS-Cov-2 RNA+ nuclei was fixed, computing the cluster enrichment score and estimating the empirical p-value as the fraction of the permutations that showed a similar or higher enrichment score compared to the observed enrichment score. Then, we adjusted the empirical p-values for multiple comparisons using FDR.
