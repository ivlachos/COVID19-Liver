Healthy reference comparison and differential gene expression
We combined the COVID-19 liver nuclei passing QC and were not marked as doublets with the control liver snRNA-seq dataset into a single expression matrix. Similarly to the COVID-19 snRNA-seq analysis, we normalized each nucleus to TP100K and log transformed the expression values (log(TP100k + 1)), selected highly variable genes, computed the first 30 principal components (PCs), corrected the PCs for batch (we considered each sample as a separate batch) using Harmony, and clustered the cells using the Harmony corrected embedding with the Leiden algorithm. We identified 5 high-level compartments in the combined data set. These high-level clusters matched the compartments identified in the COVID-19 liver data. For each high-level cluster the first 15 PCs were corrected for batch effects using Harmony and the nearest neighbor graph was calculated using the Harmony embedding. The nearest neighbor graphs were used to assign each nucleus from the healthy reference to the relevant cluster.

Differential expression analysis was carried out using limma and mean-variance modeling at the observational level (voom) [111] after summing nuclei per cluster per sample [116], and the linear model “~ Disease + SVs”, where SVs are surrogate variables estimated with iterative adjusted surrogate variable analysis (IA-SVA) [117]. The model was fit to estimate the differences between COVID-19 and healthy livers for each cluster. All clusters with at least 3 samples per group with >5 nuclei per sample were included in the analysis.
